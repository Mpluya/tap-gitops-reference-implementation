---
tap_install:
  values:
    profile: build
    ceip_policy_disclosed: true

    shared:
      ingress_domain: build.prep.tapsme.org
    
    buildservice:
      kp_default_repository: "registry.harbor.learn.tapsme.org/tap-build/build-service"

    supply_chain: testing_scanning

    ootb_supply_chain_testing_scanning:
      registry:
        server: registry.harbor.learn.tapsme.org
        repository: tap-build
      gitops:
        ssh_secret: ""
      scanning:
        image:
          policy: lax-scan-policy
        source:
          policy: lax-scan-policy

    grype:
      namespace: dev
      targetImagePullSecret: "registry-credentials"
      metadataStore:
        url: "https://metadata-store.view.prep.tapsme.org"
        caSecret:
          name: store-ca-cert
          importFromNamespace: metadata-store-secrets
        authSecret:
          name: store-auth-token
          importFromNamespace: metadata-store-secrets

    scanning:
      metadataStore:
        url: ""

    namespace_provisioner:
      controller: false
      additional_sources:
      - git:
          url: ssh://git@github.com/Mpluya/tap-namespaces
          ref: origin/main
          subPath: custom-resources
          secretRef:
            name: sync-git-ssh
            namespace: tanzu-sync
            create_export: true
        path: _ytt_lib/custom-resources
      - git:
          url: ssh://git@github.com/Mpluya/tap-namespaces
          ref: origin/main
          subPath: credentials
          secretRef:
            name: sync-git-ssh-also
            namespace: tanzu-sync
            create_export: true
        path: _ytt_lib/workload-creds
      gitops_install:
        ref: origin/main
        subPath: ns-provisioner-base
        url: ssh://git@github.com/Mpluya/tap-namespaces
        secretRef:
          name: sync-git-ssh-too
          namespace: tanzu-sync
          create_export: true
      import_data_values_secrets:
      - name: tenant-secrets
        namespace: tap-install
        create_export: true
      overlay_secrets:
      - name: workload-git-ssh-overlay
        namespace: tap-install
        create_export: true
        